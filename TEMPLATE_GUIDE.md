# Aubfest Website Template Guide

This guide explains how the templating system works in the Aubfest website project. We use EJS (Embedded JavaScript) as our templating engine with Express.js.

## Core Files Explained

### server.js
The server file is the main entry point of our application. It:
- Sets up the Express.js web server
- Configures the template engine (EJS)
- Defines routes for each page
- Handles static file serving

Key parts of server.js:
```javascript
// Set up Express and configure it
const express = require('express');
const app = express();
app.set('view engine', 'ejs');  // Use EJS for templates

// Serve static files from 'public' directory
app.use(express.static('public'));
// This is how the server knows where to find:
// - CSS files (/styles/*)
// - JavaScript files (/scripts/*)
// - Images (/images/*)

// Define routes for pages
app.get('/', (req, res) => {
    res.render('pages/index', {
        title: 'Home',
        page: 'home'
    });
});
// This tells the server:
// 1. When someone visits '/', use 'pages/index.ejs'
// 2. Pass it variables 'title' and 'page'
```

### package.json
The package.json file is your project's manifest. It:
- Lists project information
- Defines scripts to run the application
- Specifies dependencies
- Sets development dependencies

Key parts of package.json:
```json
{
    "name": "aubfest-website",
    "version": "1.0.0",
    "scripts": {
        "start": "node server.js",     // Production start
        "dev": "nodemon server.js"     // Development with auto-reload
    },
    "dependencies": {
        "express": "^4.18.2",          // Web framework
        "ejs": "^3.1.9"                // Template engine
    }
}
```

### package-lock.json
This file is automatically generated and:
- Locks exact versions of dependencies
- Ensures consistent installations across all developers
- Should be committed to version control
- Should not be edited manually

## How These Files Work Together

1. Starting the Application:
   ```bash
   npm run dev
   ```
   - npm reads package.json
   - Finds the "dev" script
   - Runs nodemon server.js

2. Server Startup:
   - server.js loads dependencies from node_modules
   - Express starts listening on port 3000
   - Static file middleware is configured
   - Routes are registered

3. Handling a Page Request:
   ```
   Browser requests '/' →
   server.js route handles it →
   renders index.ejs template →
   template includes partials →
   final HTML sent to browser →
   browser requests CSS/JS files →
   Express serves them from public/
   ```

4. Dependency Management:
   - When you run `npm install`:
     1. npm reads package.json
     2. Checks package-lock.json for exact versions
     3. Installs everything to node_modules/
     4. Your server can now require() these packages

## File Relationships

```
server.js
├── Reads from: package.json (for config)
├── Uses: node_modules/ (installed packages)
├── Serves: public/ (static files)
│   ├── styles/*.css  (referenced in HTML/EJS)
│   ├── scripts/*.js  (referenced in HTML/EJS)
│   └── images/*      (referenced in HTML/EJS)
└── Renders: views/ (EJS templates)
    ├── pages/*.ejs   (full pages)
    └── partials/*.ejs (reusable components)
```

## Common Tasks Involving These Files

### Adding a New Package
1. Install it:
   ```bash
   npm install new-package
   ```
2. package.json and package-lock.json update automatically
3. Require it in server.js:
   ```javascript
   const newPackage = require('new-package');
   ```

### Adding a New Route
In server.js:
```javascript
app.get('/new-page', (req, res) => {
    res.render('pages/new-page', {
        title: 'New Page',
        page: 'new-page'
    });
});
```

### Modifying Server Configuration
In server.js:
```javascript
// Add middleware
app.use(express.json());

// Add error handling
app.use((err, req, res, next) => {
    console.error(err);
    res.status(500).send('Something broke!');
});
```

### Running Different Environments
Add to package.json:
```json
{
    "scripts": {
        "start": "node server.js",
        "dev": "nodemon server.js",
        "prod": "NODE_ENV=production node server.js"
    }
}
```

## Troubleshooting Core Files

### Server Issues
- Port already in use: Change port in server.js
- Module not found: Run `npm install`
- Nodemon not restarting: Check file extensions in package.json

### Package Issues
- Dependency conflicts: Check package.json versions
- Installation fails: Delete node_modules and package-lock.json, run `npm install`
- Package not found: Ensure it's listed in package.json

### Static File Issues
- Files not serving: Check public/ path in server.js
- 404 errors: Verify file paths start with /
- MIME type errors: Check file extensions

## Project Structure

```
aubfest-website/
├── public/                  # Static assets
│   ├── styles/             # CSS files
│   │   ├── main.css        # Global styles
│   │   └── home.css        # Home page specific styles
│   ├── scripts/            # JavaScript files
│   │   ├── main.js         # Global scripts
│   │   └── carousel.js     # Home page carousel functionality
│   └── images/             # Image files
├── views/                  # EJS template files
│   ├── pages/             # Individual page templates
│   │   ├── index.ejs      # Home page
│   │   ├── lineup.ejs
│   │   └── ...
│   └── partials/          # Reusable components
│       ├── header.ejs     # Common header with navigation
│       └── footer.ejs     # Common footer
├── server.js              # Express server configuration
└── package.json           # Project dependencies
```

## Getting Started

1. Install dependencies:
   ```bash
   npm install
   ```

2. Start development server:
   ```bash
   npm run dev
   ```

3. Access the site at `http://localhost:3000`

## Template System

### Understanding EJS Templates

Our templates use EJS syntax:
- `<%- include('path/to/partial') %>` - Include a partial
- `<%= variable %>` - Output escaped content
- `<%- variable %>` - Output unescaped content
- `<% if (condition) { %>` - Control flow

### Available Template Variables

Each page receives these variables:
- `title`: Page title (e.g., "Home - Aubfest Music Festival")
- `page`: Current page identifier (e.g., "home", "lineup")

Example usage in templates:
```ejs
<title><%= title %></title>
<link rel="stylesheet" href="/styles/main.css">
<% if (page === 'home') { %>
    <link rel="stylesheet" href="/styles/home.css">
<% } %>
```

## Common Tasks

### Creating a New Page

1. Create a new EJS file in `views/pages/`:
   ```ejs
   <%- include('../partials/header') %>
   
   <main class="main-content">
       <!-- Your page content here -->
   </main>
   
   <%- include('../partials/footer') %>
   ```

2. Add a route in `server.js`:
   ```javascript
   app.get('/newpage', (req, res) => {
       res.render('pages/newpage', {
           title: 'New Page - Aubfest Music Festival',
           page: 'newpage'
       });
   });
   ```

3. Add page-specific styles (if needed) in `public/styles/`

### Adding Page-Specific Styles

1. Create a new CSS file in `public/styles/`
2. Link it in the header partial with a condition:
   ```ejs
   <% if (page === 'yourpage') { %>
       <link rel="stylesheet" href="/styles/yourpage.css">
   <% } %>
   ```

### Adding Page-Specific Scripts

1. Create a new JS file in `public/scripts/`
2. Link it in the footer partial with a condition:
   ```ejs
   <% if (page === 'yourpage') { %>
       <script src="/scripts/yourscript.js"></script>
   <% } %>
   ```

## Color Scheme

The site uses a consistent color scheme:
- Header: Dark green (`#006400`) with white text
- Body: Cream background (`#FFFDD0`) with forest green text (`#228B22`)
- Footer: Soft brown (`#8B4513`) with cream text
- Hover states: Cream color on dark backgrounds

## Troubleshooting

### Common Issues

1. Port already in use:
   ```bash
   Error: listen EADDRINUSE: address already in use :::3001
   ```
   Solution: Change the port number in `server.js` or kill the existing process

2. CSS not loading:
   - Check file paths start with `/` in href attributes
   - Verify files are in the correct `public` directory
   - Check browser console for 404 errors

3. Changes not showing:
   - Server automatically restarts with nodemon
   - Clear browser cache with Ctrl+F5
   - Check terminal for error messages

### Development Tips

1. Use browser dev tools (F12) to:
   - Debug CSS issues
   - Check for JavaScript errors
   - Monitor network requests

2. File Organization:
   - Keep page-specific styles in separate files
   - Use meaningful file names
   - Follow the established directory structure

3. Template Best Practices:
   - Keep partials small and focused
   - Use consistent naming conventions
   - Comment complex logic
   - Test all pages after updating shared components

## Need Help?

1. Check the EJS documentation: https://ejs.co/
2. Review Express.js docs: https://expressjs.com/